<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="../css/bootstrap.min.css">
        <style>body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <link rel="stylesheet" href="../css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="../css/main.css">

        <script src="../js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="../index.html">ITP DWD SPRING 2013</a>
                    <div class="nav-collapse collapse">
                        <ul class="nav">
                            <li class="active"><a href="../index.html">Home</a></li>
                            <!-- <li><a href="#about">About</a></li>
                            <li><a href="#contact">Contact</a></li>-->
                            <li class="dropdown">
                                <a href="week-8.html#" class="dropdown-toggle" data-toggle="dropdown">Notes <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="../page/cheatsheet.html">DWD Cheatsheet</a>
                                    </li>
                                  <li>
                                    <a href="week-1.html">
                                    Week 1 - Introduction to web development
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-2.html">
                                    Week 2 - JavaScript functions, events &amp; callbacks
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-3.html">
                                    Week 3 - Getting started with NodeJS &amp; Heroku
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-4.html">
                                    Week 4 - ExpressJS framework &amp; templates
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-5.html">
                                    Week 5 - Databases and MongoDB
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-6.html">
                                    Week 6 - More on Databases
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-7.html">
                                    Week 7 - Database review and form validation
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-8.html">
                                    Week 8 -  Introduction to API&#39;s &amp; JSON
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-9.html">
                                    Week 9 - Remote APIs, JSON and AJAX
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-10.html">
                                    Week 10 - Sessions and Cookies
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-11.html">
                                    Week 11 - Uploading files / Amazon S3
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-12.html">
                                    Week 12 - Websockets and real-time communication
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-13.html">
                                    Week 13 - Arduinos, Processing and JSON 
                                    </a>
                                  </li>
                                  <li>
                                    <a href="week-14.html">
                                    Week 14 - Final Presentations
                                    </a>
                                  </li>
                               <!--      <li><a href="#">Action</a></li>
                                    <li><a href="#">Another action</a></li>
                                    <li><a href="#">Something else here</a></li>
                                    <li class="divider"></li>
                                    <li class="nav-header">Nav header</li>
                                    <li><a href="#">Separated link</a></li>
                                    <li><a href="#">One more separated link</a></li> -->
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="week-8.html#" class="dropdown-toggle" data-toggle="dropdown">Previous Classes <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="http://itppyweb.herokuapp.com">Fall 2012 - Python</a>
                                    </li>
                                    <li>
                                        <a href="http://itpwebclassspring2012.herokuapp.com">Spring 2012 - NodeJS</a>
                                    </li>
                                </ul>
                            </li>
                            
                        </ul>
                        <form class="hide navbar-form pull-right">
                            <input class="span2" type="text" placeholder="Email">
                            <input class="span2" type="password" placeholder="Password">
                            <button type="submit" class="btn">Sign in</button>
                        </form>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>

        <div class="container">

            <div class="row">

    <div class="span2">
        <div class="well">
            <a href="week-8.html#notes">Notes</a><br>
            <a href="week-8.html#assignment">Assignment</a>
        </div>
    </div>

    <div class="span10">
        <article>
            <header>
                <h1>Week 8 -  Introduction to API&#39;s &amp; JSON</h1>
            
            </header>
            
            <div class="intro">
                <p>Creating a server-side JSON feed for sharing data with other web apps. Example of consuming remote APIs.</p>
            </div>

            <hr>
            
            <section id="notes">
                <h2 id="apis-json-because-sharing-is-caring">APIs &amp; JSON, because sharing is caring</h2>

<p>Websites can make their data and services available to other servers and applications, this process is known as an API (application programming interface).</p>

<p>Many APIs today are basically URLs that give access to data and services from a given server. Your web sites can make use of these APIs to provide new content or create a mash up between different sets of data. You might even use an API to resize your photos or transcode your video. There are many uses but the easiest way to get started is to look at one.</p>

<h2 id="json">JSON</h2>

<p>JSON --> JavaScript Object Notation</p>

<p>Your NodeJS web applications can share data in JSON format to other web applications. Those web applications can be written in NodeJS, PHP, Ruby, Python. They can can running in OpenFrameworks or Processing. They can be front end JavaScript running in a browser.</p>

<pre><code>var applePieRecipe = {
    title : "Apple Pie",
    ingredients : ['flour','butter','salt','sugar','apples','cinnamon','nutmeg'],
    categories : ['pie','dessert','apples','harvest'],
    cooking_time : "45 minutes"
};

console.log(applePieRecipe);
</code></pre>

<h3 id="converting-nodejs-javascript-objects-to-json">Converting NodeJS / Javascript objects to JSON</h3>

<p>JSON is the serialized version of native JavaScript data types.</p>

<pre><code>json_recipe = JSON.stringify(applePieRecipe);

// in ExpressJS we can send JSON very easily
res.json(applePieReceipt);
</code></pre>

<h3 id="result-is-a-json-string">Result is a JSON string</h3>

<pre><code>"{
    "title":"Apple Pie",
    "ingredients":["flour","butter","salt","sugar","apples","cinnamon","nutmeg"],
    "categories":["pie","dessert","apples","harvest"],
    "cooking_time":"45 minutes"
}"
</code></pre>

<h2 id="javascript-data-type-review">JavaScript Data Type Review</h2>

<p>Strings - in quotes</p>

<pre><code>"I'm a string"
</code></pre>

<p>Numbers - no quotes</p>

<pre><code>42
</code></pre>

<p>Arrays - Square brackets with items separated by commas</p>

<pre><code>['red','blue',42,true]
</code></pre>

<p>Objects - Curly brackets with key : value items separated by commas</p>

<pre><code>{
    name : 'Tony Pony',
    age : 42,
    city : 'New York'
}
</code></pre>

<h3 id="example-json">Example JSON</h3>

<ul>
<li><a href="http://itpdwdexpresstemplates.herokuapp.com/data/astronauts/john_watt_young">John Young JSON</a></li>
</ul>

<h2 id="responding-with-json-in-express">Responding with JSON in Express</h2>

<pre><code>exports.data_all = function(req, res) {

    // query for all astronauts
    astroQuery = astronautModel.find({}); // query for all astronauts
    astroQuery.sort('-birthdate');
    astroQuery.exec(function(err, allAstros){

        // prepare data for JSON
        var jsonData = {
            status : 'OK',
            astros : allAstros
        }

        // send JSON to requestor
        res.json(jsonData);
    });
}
</code></pre>

<h2 id="requesting-remote-json">Requesting Remote JSON</h2>

<p>We're using the <a href="https://github.com/mikeal/request">Request module</a></p>

<h3 id="update-your-packagejson">Update your package.json</h3>

<p>Add to 'dependencies' (be sure to add comma if needed)</p>

<pre><code>"request" : "2.16.6"
</code></pre>

<h3 id="update-npm">Update NPM</h3>

<p>In code directory in Terminal update npm with command...</p>

<pre><code>npm install
</code></pre>

<h3 id="demo-indexjs-function">Demo Index.js function</h3>

<h4 id="add-request-to-top-of-file">Add request to top of file</h4>

<pre><code>var request = require('request');
</code></pre>

<h4 id="function">Function</h4>

<pre><code>exports.remote_api = function(req, res) {

    var remote_api_url = 'http://itpdwdexpresstemplates.herokuapp.com/data/astronauts';
    // var remote_api_url = 'http://localhost:5000/data/astronauts';

    // make a request to remote_api_url
    request.get(remote_api_url, function(error, response, data){

        if (error){
            res.send("There was an error requesting remote api url.");
        }

        // convert data JSON string to native JS object
        var apiData = JSON.parse(data);

        // if apiData has property 'status == OK' then successful api request
        if (apiData.status == 'OK') {

            // prepare template data for remote_api_demo.html template
            var templateData = {
                astronauts : apiData.astros,
                rawJSON : data, 
                remote_url : remote_api_url
            }

            return res.render('remote_api_demo.html', templateData);
        }   
    })
};
</code></pre>

            </section>
            <br>
            <hr>
            <br>
            <section id="assigment">
                <h1>Assignment</h1>

<p>Make some or all of your data available as JSON. Share your data JSON url on this class notes site. Describe the data and how it is collected and organized in JSON.</p>

<p>Step 2. Take another classmate's JSON feed and "consume" it. You should have a new route in your app, similar to /remote_api_test. Take in the remote JSON and redisplay it as an .html template.</p>
            </section>

            <section id="comments">
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'itpdwdspring2013';

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
            </section>


        </article>
        
    </div>

    
</div>

        </div> <!-- /container -->

        <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/js/vendor/jquery-1.9.0.min.js"><\/script>')</script>

        <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/bootstrap.min.js"></script>

        <script src="../js/main.js"></script>

        <script>
            var _gaq=[['_setAccount','UA-29253415-1'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>
